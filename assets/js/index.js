$(document).ready(function(){var a=0;$(".btn-yulan").click(function(){if(a==0){$("#colzuo").attr("class","col-sm-12");$("#colyou").hide();$(".tools").hide();a++}else{$("#colzuo").attr("class","col-sm-9");$("#colyou").show();$(".tools").show();a=0}});setup_draggable();$("#copy-to-clipboard").on("click",function(){var b=$(".form-body").clone().appendTo(document.body);b.find(".tools, :hidden").remove();$.each(["draggable","droppable","sortable","dropped","ui-sortable","ui-draggable","ui-droppable","form-body"],function(e,d){b.find("."+d).removeClass(d).removeAttr("style")});var c=html_beautify(b.html());b.remove();$modal=get_modal(c,"cont").modal("show");$modal.find(".btn").remove();$modal.find(".modal-title").html("复制HTML代码");$modal.find(":input:first").select().focus();return false});$(".btntext,.btntexts").click(function(){$(tableList($(this).attr("id"))).appendTo($(".ui-sortable"));$(".labcheck input").unbind("click");$(".labcheck input").click(function(){if($(this).is(":checked")){alert("选中")}else{alert("未选中")}});$(".form_datetime").datetimepicker({language:"zh-CN",format:"yyyy/mm/dd hh:ii",initialDate:new Date(),autoclose:true,todayBtn:true});$(".uploadfile").fileinput({language:"zh"});$(".distpicker").distpicker({province:"省份名",city:"城市名",district:"区名",autoSelect:true,placeholder:false})})});var setup_draggable=function(){$(".draggable").draggable({appendTo:"body",helper:"clone"});$(".droppable").droppable({accept:".draggable",helper:"clone",hoverClass:"droppable-active",drop:function(c,d){$(".empty-form").remove();var b=$(d.draggable);if(!$(d.draggable).hasClass("dropped")){$(tableList(b.attr("id"))).appendTo(this);$(".form_datetime").datetimepicker({language:"zh-CN",format:"yyyy/mm/dd hh:ii",initialDate:new Date(),autoclose:true,todayBtn:true});$(".uploadfile").fileinput({language:"zh"});$(".distpicker").distpicker({province:"省份名",city:"城市名",district:"区名",autoSelect:true,placeholder:false})}else{if($(this)[0]!=b.parent()[0]){var a=b.clone().appendTo(this);b.remove()}}}}).sortable()};function tableList(e){var b="";switch(e){case"text":var j='<input type="text" class="form-control" placeholder="请输入文本">';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">文本：</label><div class="col-sm-7">'+j+'</div><p class="tools col-sm-3"><a class="edit-link" name="text" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a><label class="labcheck"><input type="checkbox"> 必填</label></p></div>';break;case"select":var i='<select class="form-control"><option>请选择</option><option>默认</option></select>';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">下拉框：</label><div class="col-sm-7">'+i+'</div><p class="tools col-sm-3"><a class="edit-link" name="select" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a><label class="labcheck"><input type="checkbox"> 必填</label></p></div>';break;case"textarea":var k='<textarea class="form-control" placeholder="请输入文本"></textarea>';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">多行文本：</label><div class="col-sm-7">'+k+'</div><p class="tools col-sm-3"><a class="edit-link" name="textarea" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a><label class="labcheck"><input type="checkbox"> 必填</label></p></div>';break;case"radio":var h=Math.ceil(Math.random()*100000);var g='<label class="radio-inline"><input type="radio" value="默认1" name="rad'+h+'" checked> 默认1</label><label class="radio-inline"><input type="radio" name="rad'+h+'" value="默认2"> 默认2</label>';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">单选：</label><div class="col-sm-7">'+g+'</div><p class="tools col-sm-3"><a class="edit-link" name="radio" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a></p></div>';break;case"checkbox":var a='<label class="radio-inline" style="padding-left:0px;"><input type="checkbox" name="默认1"> 默认1</label><label class="radio-inline" style="padding-left:0px;"><input type="checkbox" name="默认2"> 默认2</label>';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">多选：</label><div class="col-sm-7">'+a+'</div><p class="tools col-sm-3"><a class="edit-link" name="checkbox" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a></p></div>';break;case"datetime":var c='<input readonly="" class="form-control form_datetime" type="text" style="border: 1px solid #e5e6e7;">';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">文本：</label><div class="col-sm-7">'+c+'</div><p class="tools col-sm-3"><a class="edit-link" name="datetime" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a></p></div>';break;case"file":var d='<input class="file uploadfile" type="file" multiple data-min-file-count="1">';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">上传：</label><div class="col-sm-7">'+d+'</div><p class="tools col-sm-3"><a class="edit-link" name="file" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a></p></div>';break;case"picker":var f='<form class="form-inline"><div class="distpicker"><div class="form-group" style="margin:0px; padding-right:10px;"><label class="sr-only" for="province10">Province</label><select class="form-control" id="province10"></select></div><div class="form-group" style="margin:0px; padding-right:10px;"><label class="sr-only" for="city10">City</label><select class="form-control" id="city10"></select></div><div class="form-group" style="margin:0px; padding-right:10px;"><label class="sr-only" for="district10">District</label><select class="form-control" id="district10"></select></div></div></form>';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">省市区：</label><div class="col-sm-7">'+f+'</div><p class="tools col-sm-3"><a class="edit-link" name="picker" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a></p></div>';break;case"name":var j='<input type="text" class="form-control" placeholder="请输入你的姓名">';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">姓名：</label><div class="col-sm-7">'+j+'</div><p class="tools col-sm-3"><a class="edit-link" name="text" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a><label class="labcheck"><input type="checkbox"> 必填</label></p></div>';break;case"phone":var j='<input type="text" class="form-control" placeholder="请输入你的电话">';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">电话：</label><div class="col-sm-7">'+j+'</div><p class="tools col-sm-3"><a class="edit-link" name="text" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a><label class="labcheck"><input type="checkbox"> 必填</label></p></div>';break;case"email":var j='<input type="text" class="form-control" placeholder="请输入你的邮箱">';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">邮箱：</label><div class="col-sm-7">'+j+'</div><p class="tools col-sm-3"><a class="edit-link" name="text" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a><label class="labcheck"><input type="checkbox"> 必填</label></p></div>';break;case"card":var j='<input type="text" class="form-control" placeholder="请输入你的身份证">';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">身份证：</label><div class="col-sm-7">'+j+'</div><p class="tools col-sm-3"><a class="edit-link" name="text" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a><label class="labcheck"><input type="checkbox"> 必填</label></p></div>';break;case"www":var j='<input type="text" class="form-control" placeholder="请输入你的个人网站地址">';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">个人网站：</label><div class="col-sm-7">'+j+'</div><p class="tools col-sm-3"><a class="edit-link" name="text" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a><label class="labcheck"><input type="checkbox"> 必填</label></p></div>';break;case"logo":var d='<input class="file uploadfile" type="file" multiple data-min-file-count="1">';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">上传Logo：</label><div class="col-sm-7">'+d+'</div><p class="tools col-sm-3"><a class="edit-link" name="file" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a></p></div>';break;case"sex":var h=Math.ceil(Math.random()*100000);var g='<label class="radio-inline"><input type="radio" value="男" name="rad'+h+'" checked> 男</label><label class="radio-inline"><input type="radio" name="rad'+h+'" value="女"> 女</label>';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">性别：</label><div class="col-sm-7">'+g+'</div><p class="tools col-sm-3"><a class="edit-link" name="radio" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a></p></div>';break;case"occupation":var j='<input type="text" class="form-control" placeholder="请输入你的职位">';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">职位：</label><div class="col-sm-7">'+j+'</div><p class="tools col-sm-3"><a class="edit-link" name="text" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a><label class="labcheck"><input type="checkbox"> 必填</label></p></div>';break;case"profile":var k='<textarea class="form-control" placeholder="请输入你的简介"></textarea>';b='<div class="form-group draggable ui-draggable dropped"><label class="col-sm-2 control-label">个人简介：</label><div class="col-sm-7">'+k+'</div><p class="tools col-sm-3"><a class="edit-link" name="textarea" title="设置"><i class="fa fa-cog fa-fw"></i></a><a class="remove-link"><i class="fa fa-trash-o"></i></a><label class="labcheck"><input type="checkbox"> 必填</label></p></div>';break}return b}function tabUp(c,a){var b="";switch(c){case"text":b='<div class="row tabup"><div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">标题：</label><div class="col-sm-9"><input type="text" class="form-control" value="'+a.find("label:eq(0)").html().substring(0,a.find("label:eq(0)").html().length-1)+'" placeholder="请输入标题"></div></div><div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">提示信息：</label><div class="col-sm-9"><input type="text" class="form-control" value="'+a.find("input:eq(0)").attr("placeholder")+'" placeholder="请输入提示信息"></div></div></div>';break;case"select":b+='<div class="row tabup">';b+='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">标题：</label><div class="col-sm-9"><input type="text" class="form-control" value="'+a.find("label:eq(0)").html().substring(0,a.find("label:eq(0)").html().length-1)+'" placeholder="请输入标题"></div></div>';b+='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">子项1：</label><div class="col-sm-8"><input type="text" class="form-control" value="'+a.find("select").find("option:eq(0)").html()+'" placeholder="请输入子项"></div><label class="col-sm-1 control-label"><i class="fa fa-plus-square select-add" title="添加" style="font-size:18px; cursor:pointer;"></i></label></div>';b+='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">子项2：</label><div class="col-sm-8"><input type="text" class="form-control" value="'+a.find("select").find("option:eq(1)").html()+'" placeholder="请输入子项"></div><label class="col-sm-1 control-label"></label></div>';a.find("select").find("option").each(function(d){if(d>1){b+='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">子项'+(d+1)+'：</label><div class="col-sm-8"><input type="text" class="form-control" value="'+$(this).html()+'" placeholder="请输入子项"></div><label class="col-sm-1 control-label"><i class="fa fa-trash-o select-del" title="删除" style="font-size:18px; cursor:pointer;"></i></label></div>'}});b+="</div>";break;case"textarea":b='<div class="row tabup"><div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">标题：</label><div class="col-sm-9"><input type="text" class="form-control" value="'+a.find("label:eq(0)").html().substring(0,a.find("label:eq(0)").html().length-1)+'" placeholder="请输入标题"></div></div><div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">提示信息：</label><div class="col-sm-9"><input type="text" class="form-control" value="'+a.find("textarea").attr("placeholder")+'" placeholder="请输入提示信息"></div></div></div>';break;case"radio":b+='<div class="row tabup">';b+='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">标题：</label><div class="col-sm-9"><input type="text" class="form-control" value="'+a.find("label:eq(0)").html().substring(0,a.find("label:eq(0)").html().length-1)+'" placeholder="请输入标题"></div></div>';b+='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">子项1：</label><div class="col-sm-8"><input type="text" class="form-control" value="'+a.find("input[type='radio']:eq(0)").attr("value")+'" placeholder="请输入子项"></div><label class="col-sm-1 control-label"><i class="fa fa-plus-square select-add" title="添加" style="font-size:18px; cursor:pointer;"></i></label></div>';b+='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">子项2：</label><div class="col-sm-8"><input type="text" class="form-control" value="'+a.find("input[type='radio']:eq(1)").attr("value")+'" placeholder="请输入子项"></div><label class="col-sm-1 control-label"></label></div>';a.find("input[type='radio']").each(function(d){if(d>1){b+='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">子项'+(d+1)+'：</label><div class="col-sm-8"><input type="text" class="form-control" value="'+$(this).attr("value")+'" placeholder="请输入子项"></div><label class="col-sm-1 control-label"><i class="fa fa-trash-o select-del" title="删除" style="font-size:18px; cursor:pointer;"></i></label></div>'}});b+="</div>";break;case"checkbox":b+='<div class="row tabup">';b+='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">标题：</label><div class="col-sm-9"><input type="text" class="form-control" value="'+a.find("label:eq(0)").html().substring(0,a.find("label:eq(0)").html().length-1)+'" placeholder="请输入标题"></div></div>';b+='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">子项1：</label><div class="col-sm-8"><input type="text" class="form-control" value="'+a.find("input[type='checkbox']:eq(0)").attr("name")+'" placeholder="请输入子项"></div><label class="col-sm-1 control-label"><i class="fa fa-plus-square select-add" title="添加" style="font-size:18px; cursor:pointer;"></i></label></div>';b+='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">子项2：</label><div class="col-sm-8"><input type="text" class="form-control" value="'+a.find("input[type='checkbox']:eq(1)").attr("name")+'" placeholder="请输入子项"></div><label class="col-sm-1 control-label"></label></div>';a.find("input[type='checkbox']").each(function(d){if(d>1){b+='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">子项'+(d+1)+'：</label><div class="col-sm-8"><input type="text" class="form-control" value="'+$(this).attr("name")+'" placeholder="请输入子项"></div><label class="col-sm-1 control-label"><i class="fa fa-trash-o select-del" title="删除" style="font-size:18px; cursor:pointer;"></i></label></div>'}});b+="</div>";break;case"datetime":b='<div class="row tabup"><div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">标题：</label><div class="col-sm-9"><input type="text" class="form-control" value="'+a.find("label:eq(0)").html().substring(0,a.find("label:eq(0)").html().length-1)+'" placeholder="请输入标题"></div></div></div>';break;case"file":b='<div class="row tabup"><div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">标题：</label><div class="col-sm-9"><input type="text" class="form-control" value="'+a.find("label:eq(0)").html().substring(0,a.find("label:eq(0)").html().length-1)+'" placeholder="请输入标题"></div></div></div>';break;case"picker":b='<div class="row tabup"><div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">标题：</label><div class="col-sm-9"><input type="text" class="form-control" value="'+a.find("label:eq(0)").html().substring(0,a.find("label:eq(0)").html().length-1)+'" placeholder="请输入标题"></div></div></div>';break}return b}var get_modal=function(b,d,a){var c="";if(d=="cont"){c=$('<div class="modal" style="overflow: auto;" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><a type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</a><h4 class="modal-title">表单信息设置</h4></div><div class="modal-body ui-front"><xmp class="form-control"  style="min-height: 200px; overflow-y: auto; margin-bottom: 10px;font-family: Monaco, Fixed">'+b+'</xmp><button class="btn btn-success">确认</button></div></div></div></div>').appendTo(document.body)}else{c=$('<div class="modal" style="overflow: auto;" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><a type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</a><h4 class="modal-title">表单信息设置</h4></div><div class="modal-body ui-front">'+tabUp(d,a)+'<xmp class="form-control"  style="min-height: 200px; display:none; overflow-y: auto; margin-bottom: 10px;font-family: Monaco, Fixed">'+b+'</xmp><button class="btn btn-success">确认</button></div></div></div></div>').appendTo(document.body)}return c};$(document).on("click",".edit-link",function(e){var f=$(this).attr("name");var b=$(this).parent().parent();var c=b.clone();var a=c.find(".edit-link").parent().remove();var d=get_modal(html_beautify(c.html()),f,b).modal("show");d.find(".btn-success").click(function(g){switch(f){case"text":b.find("label:eq(0)").html($(this).parent().find("input:eq(0)").val()+"：");b.find("input:eq(0)").attr("placeholder",$(this).parent().find("input:eq(1)").val());d.modal("hide");return false;break;case"select":var h="";var i=0;$(this).parent().find("input").each(function(l,k){if(l==0){b.find("label:eq(0)").html($(this).parent().find("input:eq(0)").val()+"：")}else{if($(this).val()==""){i=1;$(this).focus();return false}else{h+="<option>"+$(this).val()+"</option>"}}});if(i!=0){alert("不能有空值！")}else{b.find("select").html(h);d.modal("hide")}break;case"textarea":b.find("label:eq(0)").html($(this).parent().find("input:eq(0)").val()+"：");b.find("textarea").attr("placeholder",$(this).parent().find("input:eq(1)").val());d.modal("hide");return false;break;case"datetime":b.find("label:eq(0)").html($(this).parent().find("input:eq(0)").val()+"：");d.modal("hide");return false;break;case"file":b.find("label:eq(0)").html($(this).parent().find("input:eq(0)").val()+"：");d.modal("hide");return false;break;case"picker":b.find("label:eq(0)").html($(this).parent().find("input:eq(0)").val()+"：");d.modal("hide");return false;break;case"radio":var h="";var i=0;var j=Math.ceil(Math.random()*100000);$(this).parent().find("input").each(function(l,k){if(l==0){b.find("label:eq(0)").html($(this).parent().find("input:eq(0)").val()+"：")}else{if(l==1){if($(this).val()==""){i=1;$(this).focus();return false}else{h+='<label class="radio-inline"><input type="radio" name="rad'+j+'" value="'+$(this).val()+'" checked=""> '+$(this).val()+"</label>"}}else{if($(this).val()==""){i=1;$(this).focus();return false}else{h+='<label class="radio-inline"><input type="radio" name="rad'+j+'" value="'+$(this).val()+'" > '+$(this).val()+"</label>"}}}});if(i!=0){alert("不能有空值！")}else{b.find("div[class='col-sm-7']").html(h);d.modal("hide")}return false;break;case"checkbox":var h="";var i=0;$(this).parent().find("input").each(function(l,k){if(l==0){b.find("label:eq(0)").html($(this).parent().find("input:eq(0)").val()+"：")}else{if(l==1){if($(this).val()==""){i=1;$(this).focus();return false}else{h+='<label class="radio-inline"><input type="checkbox" name="'+$(this).val()+'"> '+$(this).val()+"</label>"}}else{if($(this).val()==""){i=1;$(this).focus();return false}else{h+='<label class="radio-inline"><input type="checkbox" name="'+$(this).val()+'" > '+$(this).val()+"</label>"}}}});if(i!=0){alert("不能有空值！")}else{b.find("div[class='col-sm-7']").html(h);d.modal("hide")}return false;break}});d.find(".select-add").click(function(){var g='<div class="col-sm-12" style="margin-bottom:10px"><label class="col-sm-3 control-label">子项1：</label><div class="col-sm-8"><input type="text" class="form-control" value="" placeholder="请输入子项"></div><label class="col-sm-1 control-label"><i class="fa fa-trash-o select-del" title="删除" style="font-size:18px; cursor:pointer;"></i></label></div>';$(this).parent().parent().parent().parent().find("div[class='row tabup']").append(g);$(".select-del").unbind("click");$(".select-del").click(function(){var h=confirm("是否删除？");if(h==true){$(this).parent().parent().remove()}});$(this).parent().parent().parent().parent().find("label[class='col-sm-3 control-label']").each(function(i,h){if(i>1){$(this).html("子项"+i+"：")}})});$(".select-del").unbind("click");d.find(".select-del").click(function(){var g=confirm("是否删除？");if(g==true){$(this).parent().parent().remove()}})});$(document).on("click",".remove-link",function(a){var b=confirm("是否删除？");if(b==true){$(this).parent().parent().remove()}});